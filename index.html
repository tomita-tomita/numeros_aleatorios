<!DOCTYPE html>
<html lang="pt-br">
	<head>
    	<meta charset="utf-8">
    	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
    	<title>Random()</title>

    	<link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">    	

	</head>
	<body>
		<div class="col-md-12" style="margin-top: 2rem">
  			<div class="panel-group">
				<div class="panel panel-default">
      				<div class="panel-heading"></div>
      					<div class="panel-body">
						<div class="row ">
				  			<div class="col-md-6">					    		 
				    			<div class="input-group">
			    					<label>1ª semente inicial</label>
			      					<input id="primeira_inicial" type="number" class="form-control" placeholder="Primeira Semente inicial">					      					      		
				    			</div>
				    			<br>				    					    
				    			<div class="input-group">	
				    				<label>2ª semente inicial</label>			    				
				      				<input id="segunda_inicial" type="number" class="form-control" placeholder="Segunda semente inicial">					      					      			
				    			</div>
								<br>
				    			<div class="input-group">	
				    				<label>a</label>		    				
				      				<input id="a" type="number" class="form-control" placeholder="Valor para a" value="16807">					      					      			
				    			</div>
								<br>
				    			<div class="input-group">	
				    				<label>b</label>			    				
				      				<input id="b" type="number" class="form-control" placeholder="Valor para b">					      					     
				    			</div>
								<br>
				    			<div class="input-group">	
				    				<label>m</label>			    				
				      				<input id="m" type="number" class="form-control" placeholder="Valor para m" value="2147483647">					      					      
				    			</div>
								<br>																								
				    			<div class="input-group">		
				    				<label>Quantidade de amostras</label>		    				
				      				<input id="qtd_amostras" type="number"  class="form-control" placeholder="Quantidade" value="3000">					      					      					
				    			</div>
				    			<div class="row col-md-12" style="margin-top: 1rem;">
					    			<div>	
				        				<button class="btn btn-primary" type="button" id="botao_carregar">Carregar</button>					        					       			      		
				        				<!-- <button class="btn btn-primary" type="button" id="botao_limpar">Limpar</button> -->					        					       			      		
				        				<!-- <button class="btn btn-primary" type="button" id="botao">Sortear!</button> -->					        					       
				        				<button class="btn btn-primary" type="button" id="linear_potencia">Linear Potencia</button>					        					       
				        				<button class="btn btn-primary" type="button" id="linear_adaptado">Linear Adaptado</button>					        					       
				        				<button class="btn btn-primary" type="button" id="linear_multiplicativo">Linear Multiplicativo</button>					        					
				        				<button class="btn btn-primary" type="button" id="quadrado_meio">Quadrado do Meio</button>					        					       
				        				<button class="btn btn-primary" type="button" id="fibonacci">Fibonacci</button>					        					       
				      				</div>
			      				</div>		      								    											
			    			</div>
			    			<div class="col-lg-6">
								<strong>Congruente Linear Adaptado</strong><br>
									<span style="padding-left: 2rem">X<sub>n+1</sub> = (a*X<sub>n</sub>+b) % m</span>
									<br><br>
								<strong>Congruente Linear Multiplicativo</strong><br>
									<span style="padding-left: 2rem">X<sub>n+1</sub> = (a*X<sub>n</sub>) % m</span>
									<br><br>
								<strong>Congruente Linear Potências</strong><br>
									<span style="padding-left: 2rem">X<sub>n</sub> = a<sup>n</sup> % m</span>
									<br><br>
								<strong>Quadrado do Meio</strong><br>
									<span style="padding-left: 2rem">X<sub>n</sub> = (Meio de X<sub>n-1</sub>)²
									<br><br>
								<strong>Fibonacci</strong><br>						
									<span style="padding-left: 2rem">X<sub>n</sub> = X<sub>n-i</sub> operação (%) X<sub>n-j</sub>
									<br><br>
								<div style="margin-top: 3rem">	
									<table class="table-bordered">
										<thead>
											<tr>
												<th style="text-align: center;">a</th>	
												<th style="text-align: center">m</th>	
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>7⁵</td>																
												<td>2³¹-1</td>
											</tr>											
										</tbody>																			
									</table>
								</div>
			    			</div>
		    			</div>    					      				
					</div>
				</div>
			</div>
		</div>
		<div class="col-md-12">
  			<div class="panel-group">
				<div class="panel panel-default">
      				<div class="panel-heading">Resultados</div>
  					<div class="panel-body">      							
						<div class="row">
							<div class="col-lg-6">					    										
				    			<div id="numbers" class="hide col-md-6">									
								</div>
				  			</div>
						</div> 	
					</div>		
				</div>
			</div>
		</div>		
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    	<script src="assets/bootstrap/js/bootstrap.min.js"></script>
  </body>
	<script type="text/javascript">
		$(document).ready(function(){
			$primeiro_sortiado = Math.floor((Math.random() * 100) + 1);
			$segundo_sortiado = Math.floor((Math.random() * 100) + 1);
			$('#primeira_inicial').val($primeiro_sortiado);
			$('#segunda_inicial').val($segundo_sortiado);
		});

		$('#botao_carregar').on('click', function(){					
			limpar();
			$primeiro_sortiado = Math.floor((Math.random() * 100) + 1);
			$segundo_sortiado = Math.floor((Math.random() * 100) + 1);		
			$('#primeira_inicial').val($primeiro_sortiado);
			$('#segunda_inicial').val($segundo_sortiado);						
		});

		$('#linear_potencia').on('click', function(){
			limpar();
			$primeira = $('#primeira_inicial').val();
			$segunda = $('#segunda_inicial').val();
			$a = $('#a').val();
			$b = $('#b').val();
			$m = $('#m').val();
			$quantidade_amostras = $('#qtd_amostras').val();			
			$('#numbers').removeClass('hide');	
			linear_potencia($a, $m, $quantidade_amostras, $b, $primeira, $segunda);	
		});

		$('#linear_adaptado').on('click', function(){
			limpar();
			$primeira = $('#primeira_inicial').val();
			$segunda = $('#segunda_inicial').val();
			$a = $('#a').val();
			$b = $('#b').val();
			$m = $('#m').val();
			$quantidade_amostras = $('#qtd_amostras').val();			
			$('#numbers').removeClass('hide');		
			linear_adaptado($a, $b, $m, $quantidade_amostras, $primeira, $segunda);	
		});

		$('#linear_multiplicativo').on('click', function(){
			limpar();
			$primeira = $('#primeira_inicial').val();
			$segunda = $('#segunda_inicial').val();			
			$b = $('#b').val();			
			$a = $('#a').val();
			$m = $('#m').val();
			$quantidade_amostras = $('#qtd_amostras').val();			
			$('#numbers').removeClass('hide');		
			linear_multiplicativo($a, $b, $m, $quantidade_amostras, $primeira, $segunda);	
		});

		$('#quadrado_meio').on('click', function(){
			limpar();
			$primeira = $('#primeira_inicial').val();
			$segunda = $('#segunda_inicial').val();
			$a = $('#a').val();
			$b = $('#b').val();
			$m = $('#m').val();
			$quantidade_amostras = $('#qtd_amostras').val();			
			$('#numbers').removeClass('hide');	
			quadrado_meio($a, $b, $m, $quantidade_amostras, $primeira, $segunda);			
		});
		
		$('#fibonacci').on('click', function(){
			limpar();
			$primeira = $('#primeira_inicial').val();
			$segunda = $('#segunda_inicial').val();
			$a = $('#a').val();
			$b = $('#b').val();
			$m = $('#m').val();
			$quantidade_amostras = $('#qtd_amostras').val();			
			$('#numbers').removeClass('hide');	
			fibonacci($a, $b, $m, $quantidade_amostras, $primeira, $segunda);			
		});

		function imprime_csv ($amostras, $metodo){
			var A = [['posição','Número gerado']];

			for(var j=0; j<$amostras.length; ++j){ 
			    A.push([j, $amostras[j]]);
			}

			var csvRows = [];

			for(var i=0, l=A.length; i<l; ++i){
			    csvRows.push(A[i].join(';'));
			}

			var csvString = csvRows.join("%0A");
			var a         = document.createElement('a');
			a.href        = 'data:attachment/csv,' + csvString;
			a.target      = '_blank';
			a.download    =  $metodo+'.csv';

			document.body.appendChild(a);
			a.click();
		}

		function limpar(){
			$('#numbers').html('');
		};
		
		function linear_potencia ($a, $m, $quantidade_amostras, $b, $primeira, $segunda){
			$amostras = [];
			$('#numbers').append('<p><strong>Linear Potencia</strong></p>');						
			for(var i = 0; i < $quantidade_amostras; i++){						
				$amostras[i] = (Math.pow($a, i) % $m);				
			}			
			imprime_csv($amostras, 'Linear Potencias');
			calcula_chi_quadradido($amostras);
		};

		function linear_adaptado ($a, $b, $m, $quantidade_amostras, $primeira, $segunda){
			if(!$b){
				limpar();
				alert('Verifique o valor de b');				
			}else{
				$amostras = [];
				$amostras[0] = $primeira			
				$b = parseInt($('#b').val());			
				$('#numbers').append('<p><strong>Linear Adaptado</strong></p>');				
				for(var i = 1; i < $quantidade_amostras; i++){							
					$amostras[i] = (($a * $amostras[i-1]) + $b) % $m;
				}
				imprime_csv($amostras, 'Linear Adaptado');
				calcula_chi_quadradido($amostras);							
			}
		};

		function linear_multiplicativo ($a, $b, $m, $quantidade_amostras, $primeira, $segunda){
			$amostras = [];
			$amostras[0] = $primeira;
			$('#numbers').append('<p><strong>Linear Multiplicativo</strong></p>');			
			for(var i = 1; i < $quantidade_amostras; i++){							
				$amostras[i] = ($a * $amostras[i-1]) % $m;					
			}
			imprime_csv($amostras, 'Linear Multiplicativo');
			calcula_chi_quadradido($amostras);
		};
			
		function quadrado_meio ($a, $b, $m, $quantidade_amostras, $primeira, $segunda){
			$amostras = [];
			$amostras[0] = $primeira;
			$tamanho = $primeira.toString().length;			
			$novaSemente = '';
			$('#numbers').append('<p><strong>Quadrado do meio</strong></p>');			
			for(var i = 1; i < $quantidade_amostras; i++){		
	  			if(i == 1){
	  				$atual =  Math.pow($amostras[i-1],2);	  			  		
	  			}else{
	  				$atual =  Math.pow($novaSemente,2);
	  				$novaSemente = '';
	  			}	  						
				
	  			for (var j = Math.ceil($atual.toString().length)-$tamanho; j < Math.ceil($atual.toString().length); j++) {	  			
					$novaSemente = $novaSemente + $atual.toString()[j];							
	  			}  				
								
				if(i == 1){
					$novaSemente = $amostras[0];
				}			
				$amostras[i] = Math.pow($novaSemente,2);	  										
			}		
			imprime_csv($amostras, 'Quadrado do Meio');
			calcula_chi_quadradido($amostras);
		};
	
		function fibonacci ($a, $b, $m, $quantidade_amostras, $primeira, $segunda){
			$amostras = [];
			$amostras[0] = $primeira;
			$amostras[1] = $segunda;
			$('#numbers').append('<p><strong>Fibonacci</strong></p>');	
			for(var i = 2; i < $quantidade_amostras; i++){
				$amostras[i] = $amostras[i-2] % $amostras[i-1];							
			}
			imprime_csv($amostras, 'Fibonacci');
			calcula_chi_quadradido($amostras);
		};

		function calcula_chi_quadradido ($array){								
			$teste = [];
			$chi = 0;
			$esperado = (1/500).toFixed(3);			
			for(var i = 0; i < 500; i++){		
				$teste[$amostras[i]] = 0;				
			}			
			for (var key in $teste) {
				for(var i = 0; i < 500; i++){
					if($amostras[i] == key){						
						$teste[key] = $teste[key]+1; 						
					}
				}							  
			}	
			for(var key in $teste){							
				$chi = $chi + Math.pow((($teste[key]*$esperado) - $esperado), 2) / $esperado;
			}			
			$('#numbers').append('<p class="num_sorteado_potencia"><strong>Chi-quadrado 500 amostras</strong>: '+$chi.toFixed(2)+'</p>');

			$teste = [];
			$chi = 0;
			$esperado = (100/1500).toFixed(3);			
			for(var i = 0; i < 1500; i++){		
				$teste[$amostras[i]] = 0;				
			}			
			for (var key in $teste) {
				for(var i = 0; i < 1500; i++){
					if($amostras[i] == key){						
						$teste[key] = $teste[key]+1; 						
					}
				}							  
			}			
			for(var key in $teste){							
				$chi = $chi + Math.pow((($teste[key]*$esperado) - $esperado), 2) / $esperado;
			}			
			$('#numbers').append('<p class="num_sorteado_potencia"><strong>Chi-quadrado 1500 amostras</strong>: '+$chi.toFixed(2)+'</p>');

			$teste = [];
			$chi = 0;
			$esperado = (100/3000).toFixed(3);			
			for(var i = 0; i < 3000; i++){		
				$teste[$amostras[i]] = 0;				
			}			
			for (var key in $teste) {
				for(var i = 0; i < 3000; i++){
					if($amostras[i] == key){	
						$teste[key] = $teste[key]+1; 						
					}
				}							  
			}			
			for(var key in $teste){							
				$chi = $chi + Math.pow((($teste[key]*$esperado) - $esperado), 2) / $esperado;
			}			
			$('#numbers').append('<p class="num_sorteado_potencia"><strong>Chi-quadrado 300 amostras</strong>: '+$chi.toFixed(2)+'</p>');	
		};

  </script>  
</html>
